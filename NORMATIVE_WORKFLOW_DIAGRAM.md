# 🔄 Визуальная схема процесса работы Нормативщика

```
┌─────────────────────────────────────────────────────────────────────┐
│                    ПРОЦЕСС РАБОТЫ НОРМАТИВЩИКА                      │
└─────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────┐
│ ЭТАП 1: ДОБАВЛЕНИЕ НОРМАТИВНОГО ДОКУМЕНТА                           │
└─────────────────────────────────────────────────────────────────────┘

    Библиотека норм
         ↓
    [+ Добавить норматив]
         ↓
    ┌─────────────────────┐
    │ Заполнить форму:    │
    │ • Код (СН РК...)    │
    │ • Название          │
    │ • Тип документа     │
    │ • Юрисдикция (KZ)   │
    │ • Дата публикации   │
    │ • Ключевые слова    │
    └─────────────────────┘
         ↓
    [Сохранить]
         ↓
    ✅ НД создан в системе


┌─────────────────────────────────────────────────────────────────────┐
│ ЭТАП 2: ЗАГРУЗКА И ПАРСИНГ PDF                                      │
└─────────────────────────────────────────────────────────────────────┘

    Открыть НД
         ↓
    Вкладка "Файлы"
         ↓
    [Загрузить PDF]
         ↓
    Выбрать файл с компьютера
         ↓
    ✅ PDF загружен
         ↓
    Вкладка "Сырые фрагменты"
         ↓
    [Парсить PDF]
         ↓
    ┌─────────────────────────────────────────┐
    │  ПАРСИНГ (5-30 минут)                   │
    │  ┌───────────────────────────────────┐  │
    │  │ PDF → Текст                       │  │
    │  │   ↓                               │  │
    │  │ Разбивка на части (chunks)        │  │
    │  │   ↓                               │  │
    │  │ OpenAI GPT-4o-mini                │  │
    │  │   ↓                               │  │
    │  │ Извлечение фрагментов             │  │
    │  │   ↓                               │  │
    │  │ Сохранение в БД (PENDING)         │  │
    │  └───────────────────────────────────┘  │
    └─────────────────────────────────────────┘
         ↓
    ✅ Фрагменты извлечены


┌─────────────────────────────────────────────────────────────────────┐
│ ЭТАП 3: РЕВЬЮ И ОДОБРЕНИЕ ФРАГМЕНТОВ                                │
└─────────────────────────────────────────────────────────────────────┘

    Вкладка "Сырые фрагменты"
         ↓
    ┌─────────────────────────────────────────┐
    │ Список фрагментов (PENDING)             │
    │                                         │
    │ Фрагмент #1: "должен обеспечивать..."   │
    │ ┌─────────────┬─────────────┐           │
    │ │ ✓ Одобрить  │ ✗ Отклонить │           │
    │ └─────────────┴─────────────┘           │
    │                                         │
    │ Фрагмент #2: "Термины и определения"    │
    │ ┌─────────────┬─────────────┐           │
    │ │ ✓ Одобрить  │ ✗ Отклонить │           │
    │ └─────────────┴─────────────┘           │
    │                                         │
    │ ...                                     │
    └─────────────────────────────────────────┘
         ↓
    Для КАЖДОГО фрагмента:
         ↓
    ┌─────────────────────────────────────────┐
    │ Это требование?                         │
    │                                         │
    │ ДА → [✓ Одобрить] → APPROVED (🟢)       │
    │                                         │
    │ НЕТ → [✗ Отклонить] → REJECTED (🔴)     │
    └─────────────────────────────────────────┘
         ↓
    ✅ Все фрагменты просмотрены
    
    Статистика:
    • Ожидают: 0
    • Одобрено: 45 🟢
    • Отклонено: 15 🔴


┌─────────────────────────────────────────────────────────────────────┐
│ ЭТАП 4: КОНВЕРТАЦИЯ В ТРЕБОВАНИЯ                                    │
└─────────────────────────────────────────────────────────────────────┘

    [Конвертировать (45)]
         ↓
    ┌─────────────────────────────────────────┐
    │ ⚠️ ПРЕДУПРЕЖДЕНИЕ                       │
    │                                         │
    │ Конвертировать 45 фрагментов?          │
    │                                         │
    │ Новые требования будут ДОБАВЛЕНЫ        │
    │ к существующим.                         │
    │                                         │
    │ Существующие требования НЕ будут        │
    │ удалены.                                │
    │                                         │
    │        [Отмена]    [OK]                 │
    └─────────────────────────────────────────┘
         ↓
    [OK]
         ↓
    ┌─────────────────────────────────────────┐
    │  КОНВЕРТАЦИЯ (1-5 минут)                │
    │  ┌───────────────────────────────────┐  │
    │  │ APPROVED фрагменты                │  │
    │  │   ↓                               │  │
    │  │ OpenAI GPT-4o-mini                │  │
    │  │   ↓                               │  │
    │  │ Структурирование:                 │  │
    │  │ • clause (пункт)                  │  │
    │  │ • requirementTextShort            │  │
    │  │ • requirementTextFull             │  │
    │  │ • checkMethod                     │  │
    │  │ • tags                            │  │
    │  │ • severityHint                    │  │
    │  │   ↓                               │  │
    │  │ Сохранение Requirements           │  │
    │  │   ↓                               │  │
    │  │ Фрагменты → PROCESSED (🔵)        │  │
    │  └───────────────────────────────────┘  │
    └─────────────────────────────────────────┘
         ↓
    ✅ Успешно создано 45 требований


┌─────────────────────────────────────────────────────────────────────┐
│ ЭТАП 5: ФИНАЛИЗАЦИЯ                                                 │
└─────────────────────────────────────────────────────────────────────┘

    Вкладка "Требования"
         ↓
    ┌─────────────────────────────────────────┐
    │ Список требований                       │
    │                                         │
    │ REQ-ef1e40bc-0001                       │
    │ Пункт: 5.1.2                            │
    │ Текст: "АПС должна обеспечивать..."     │
    │ Метод: visual                           │
    │ Критичность: HIGH                       │
    │ [Редактировать] [Удалить]               │
    │                                         │
    │ REQ-ef1e40bc-0002                       │
    │ ...                                     │
    └─────────────────────────────────────────┘
         ↓
    Для КАЖДОГО требования:
         ↓
    ┌─────────────────────────────────────────┐
    │ 1. Проверить текст                      │
    │ 2. Установить критичность               │
    │ 3. Выбрать метод проверки               │
    │ 4. Добавить теги                        │
    │ 5. Удалить дубликаты (если есть)        │
    └─────────────────────────────────────────┘
         ↓
    ✅ Требования готовы для аудитов!


┌─────────────────────────────────────────────────────────────────────┐
│ ИТОГОВЫЙ РЕЗУЛЬТАТ                                                  │
└─────────────────────────────────────────────────────────────────────┘

    ✅ НД добавлен в систему
    ✅ PDF загружен и распарсен
    ✅ Фрагменты просмотрены и одобрены
    ✅ Требования созданы и отредактированы
    ✅ Готово для использования в аудитах

    ┌─────────────────────────────────────────┐
    │ Теперь аудиторы могут:                  │
    │ • Создавать проекты аудита              │
    │ • Выбирать требования из этого НД       │
    │ • Проводить проверки                    │
    │ • Фиксировать дефекты                   │
    │ • Генерировать отчеты                   │
    └─────────────────────────────────────────┘


═══════════════════════════════════════════════════════════════════════

ЛЕГЕНДА СТАТУСОВ:

Фрагменты:
  🟡 PENDING   - Ожидает ревью нормативщика
  🟢 APPROVED  - Одобрено, готово к конвертации
  🔴 REJECTED  - Отклонено, не будет конвертировано
  🔵 PROCESSED - Уже конвертировано в требования

Критичность требований:
  🔴 CRITICAL - Критическое (угроза жизни)
  🟠 HIGH     - Высокое (серьезное нарушение)
  🟡 MEDIUM   - Среднее (умеренное нарушение)
  🟢 LOW      - Низкое (незначительное)

Методы проверки:
  👁️ visual      - Визуальный осмотр
  📏 measurement  - Измерение приборами
  📄 document     - Проверка документации
  🧪 test         - Испытание/тестирование
  🧮 calculation  - Расчет

═══════════════════════════════════════════════════════════════════════

